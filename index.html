<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mr Bust Poker - The Journey</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c;
            color: #e2e8f0;
        }
        .bg-hero {
            background-image: url('https://images.unsplash.com/photo-1594916847055-649479b1836a?q=80&w=2670&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D');
            background-position: center;
            background-size: cover;
            background-blend-mode: multiply;
            background-color: rgba(13, 19, 27, 0.7);
        }
        .text-shadow-custom {
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        .progress-container {
            height: 2rem;
            background-color: #374151;
            border-radius: 9999px;
            overflow: hidden;
            position: relative;
        }
        .progress-bar {
            height: 100%;
            background-color: #f59e0b;
            transition: width 0.5s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1a202c;
            font-weight: 600;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-200">

    <!-- Firebase SDK Imports -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, onSnapshot, setDoc, getDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { setLogLevel } from 'https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js';

        // Global variables provided by the Canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        let app, db, auth;
        const bankrollAmountEl = document.getElementById('bankroll-amount');
        const progressBar = document.getElementById('progress-bar');
        const progressText = document.getElementById('progress-text');
        const userIdEl = document.getElementById('user-id-el');

        const startingBankroll = 1;
        const bankrollGoal = 100000;
        
        // This function sets up the app with Firebase
        async function setupFirebase() {
            if (Object.keys(firebaseConfig).length === 0) {
                console.error("Firebase config is missing.");
                return;
            }
            
            app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            auth = getAuth(app);
            setLogLevel('debug');
            
            // Authenticate the user using the provided token or anonymously
            try {
                if (initialAuthToken) {
                    await signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await signInAnonymously(auth);
                }
            } catch (error) {
                console.error("Authentication error:", error);
            }

            // Listen for changes in the auth state
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    const userId = user.uid;
                    console.log("User authenticated:", userId);
                    userIdEl.textContent = `User ID: ${userId}`;
                    
                    // CRITICAL FIX: The path is now set to read from the 'bankroll' document
                    // inside the 'bankroll' collection as specified by the user.
                    const bankrollRef = doc(db, "artifacts", appId, "public", "data", "bankroll", "bankroll");

                    try {
                        // First, ensure the document exists.
                        const docSnap = await getDoc(bankrollRef);
                        if (!docSnap.exists()) {
                            await setDoc(bankrollRef, {
                                currentBankroll: startingBankroll,
                                lastUpdated: serverTimestamp()
                            });
                            console.log("Initial bankroll document created successfully.");
                        } else {
                            console.log("Bankroll document already exists.");
                        }

                        // Now, set up the real-time listener.
                        onSnapshot(bankrollRef, (snapshot) => {
                            if (snapshot.exists()) {
                                const data = snapshot.data();
                                const currentBankroll = data.currentBankroll;
                                
                                const progressPercentage = (currentBankroll / bankrollGoal) * 100;
                                
                                // Update progress bar width and text
                                progressBar.style.width = `${progressPercentage.toFixed(2)}%`;
                                progressText.textContent = `${progressPercentage.toFixed(2)}%`;
                                bankrollAmountEl.textContent = `$${currentBankroll.toFixed(0)} / $${bankrollGoal}`;
                                console.log(`Bankroll updated to: ${currentBankroll}`);
                            } else {
                                console.warn("Bankroll document no longer exists.");
                                bankrollAmountEl.textContent = `$0 / $${bankrollGoal}`;
                                progressBar.style.width = `0%`;
                                progressText.textContent = `0.00%`;
                            }
                        }, (error) => {
                            console.error("Error fetching bankroll data:", error);
                        });
                        
                    } catch (error) {
                        console.error("Error setting up bankroll data:", error);
                    }
                } else {
                    console.log("User is not signed in.");
                }
            });
        }
        
        // Call the setup function when the page loads
        document.addEventListener('DOMContentLoaded', setupFirebase);
    </script>

    <!-- Header -->
    <header class="bg-gray-800 bg-opacity-70 backdrop-blur-sm shadow-lg fixed w-full z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="https://www.youtube.com/@mrbustpoker" target="_blank" class="flex items-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" class="w-20 h-20">
                    <!-- Solid Gold Spade -->
                    <path d="M50 10 L80 40 L70 40 L70 70 L50 90 L30 70 L30 40 L20 40 Z" fill="gold" />
                </svg>
            </a>
            <div class="flex items-center space-x-6">
                <a href="https://www.youtube.com/@mrbustpoker" target="_blank" class="text-white hover:text-yellow-400 transition-colors duration-300">
                    YouTube
                </a>
                <a href="https://x.com/mrbustpoker" target="_blank" class="text-white hover:text-yellow-400 transition-colors duration-300">
                    X
                </a>
                <a href="https://twitch.tv/mrbustpoker" target="_blank" class="text-white hover:text-yellow-400 transition-colors duration-300">
                    Twitch
                </a>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <main>
        <div class="bg-hero min-h-screen flex items-center justify-center p-6">
            <div class="text-center max-w-4xl space-y-8 p-8 md:p-12 bg-gray-800 bg-opacity-80 rounded-2xl shadow-xl border border-yellow-400 border-opacity-30">
                <h1 class="text-4xl md:text-6xl font-extrabold text-white leading-tight">
                    From Bust to Building
                </h1>
                <p class="text-xl text-yellow-200">A project by Mapz Poker</p>
                <p class="text-lg md:text-xl text-gray-300">
                    This is the unfiltered journey of a poker player on the grind. Follow the highs, the lows, the lessons learned, and the ultimate fight to turn a bust into a breakthrough.
                </p>
                <a href="https://www.youtube.com/@mrbustpoker" target="_blank" class="inline-block bg-yellow-400 text-gray-900 font-bold py-3 px-8 rounded-full shadow-lg hover:bg-yellow-500 transform transition-transform duration-300 hover:scale-105">
                    Follow the Journey on YouTube
                </a>
            </div>
        </div>

        <!-- About Section -->
        <section id="about" class="py-20 px-6">
            <div class="container mx-auto max-w-5xl space-y-12">
                <div class="text-center">
                    <h2 class="text-3xl md:text-4xl font-bold text-yellow-400 mb-4">The Story</h2>
                    <p class="text-lg text-gray-300 max-w-3xl mx-auto">
                        After many years as a successful poker professional, a 3-month bender in Taipei quickly depleted my bankroll to critical levels. Now, I'm on a mission to rebuild and prove that discipline, grit, and a million hands can change everything. This is more than poker; it's a journey of self-improvement and turning life around.
                    </p>
                </div>
            </div>
        </section>
        
        <!-- Tracker Section -->
        <section id="tracker" class="py-20 px-6 bg-gray-800">
            <div class="container mx-auto max-w-5xl text-center" id="tracker-section">
                <h2 class="text-3xl md:text-4xl font-bold text-yellow-400 mb-8">The Bankroll Tracker</h2>
                
                <!-- Bankroll Progress Bar - Clickable -->
                <a href="profits.html" class="block w-full max-w-2xl mx-auto mb-4 transform transition-transform duration-300 hover:scale-105">
                    <div class="progress-container">
                        <div id="progress-bar" class="progress-bar absolute" style="width: 0%;"></div>
                        <div class="absolute w-full h-full flex items-center justify-between px-4">
                            <span id="progress-text" class="text-white text-lg font-bold">0.00%</span>
                            <span id="bankroll-amount" class="text-white text-lg font-bold">$1 / $100,000</span>
                        </div>
                    </div>
                </a>
            </div>
        </section>
        
        <!-- Challenges Section -->
        <section id="challenges" class="py-20 px-6">
            <div class="container mx-auto max-w-5xl space-y-12 text-center">
                <h2 class="text-3xl md:text-4xl font-bold text-yellow-400">The Challenges</h2>
                <p class="text-lg text-gray-300 max-w-3xl mx-auto">
                    These are the core challenges driving the channel.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Challenge 1 -->
                    <div class="bg-gray-700 p-8 rounded-2xl shadow-lg border border-gray-600 space-y-4">
                        <div class="text-5xl text-yellow-400 mb-4">🏆</div>
                        <h3 class="text-2xl font-bold text-white">The $100k Challenge</h3>
                        <p class="text-gray-300">
                            The ultimate bankroll challenge. Follow me as I grind my way from my starting bankroll to reach the ultimate goal of $100,000.
                        </p>
                    </div>
                    <!-- Challenge 2 -->
                    <div class="bg-gray-700 p-8 rounded-2xl shadow-lg border border-gray-600 space-y-4">
                        <div class="text-5xl text-yellow-400 mb-4">⏱️</div>
                        <h3 class="text-2xl font-bold text-white">A Million Hands in a Year</h3>
                        <p class="text-gray-300">
                            A test of discipline, endurance, and skill. This extreme volume grind is the engine of my journey and the foundation of my professional poker career.
                        </p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Mini-Challenges Section -->
        <section id="mini-challenges" class="py-20 px-6 bg-gray-800">
            <div class="container mx-auto max-w-5xl space-y-12 text-center">
                <h2 class="text-3xl md:text-4xl font-bold text-yellow-400">Mini Challenges</h2>
                <p class="text-lg text-gray-300 max-w-3xl mx-auto">
                    In between the major challenges, I'll be taking on smaller, more focused goals to keep the grind fresh and the content engaging.
                </p>
                <div class="bg-gray-700 p-8 rounded-2xl shadow-lg border border-gray-600">
                    <ul class="text-lg text-gray-300 list-disc list-inside space-y-3 text-left max-w-xl mx-auto">
                        <li>**Lockdown Challenges:** Focused grinds to hit a specific goal in a short, intense period.</li>
                        <li>**Volume Challenges:** Pushing the limits of how many hands can be played in a set amount of time.</li>
                        <li>**Hourly Challenges:** Can I make $X per hour at a specific stake?</li>
                        <li>**Testing New Sites:** Exploring and reviewing new online poker rooms.</li>
                        <li>**Travel Grinds:** Mixing poker with new locations and vlogs.</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Call to Action Section -->
        <section id="youtube" class="py-20 px-6">
            <div class="container mx-auto max-w-5xl text-center">
                <div class="bg-gray-700 p-8 md:p-12 rounded-2xl shadow-lg border border-green-500 border-opacity-30">
                    <h2 class="text-3xl md:text-4xl font-bold text-green-500 mb-4">Join the Journey</h2>
                    <p class="text-lg text-gray-300 mb-6">
                        Don't miss a single hand. Subscribe to the Mr Bust Poker channel to follow the entire journey, get strategy tips, and watch the transformation unfold.
                    </p>
                    <a href="https://www.youtube.com/@mrbustpoker" target="_blank" class="inline-block bg-red-600 text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-red-700 transform transition-transform duration-300 hover:scale-105">
                        <div class="flex items-center justify-center space-x-2">
                            <span>Subscribe on YouTube</span>
                        </div>
                    </a>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 py-6 px-6 text-center text-gray-500 text-sm">
        <p>&copy; 2025 Mr Bust Poker. All Rights Reserved.</p>
        <p>A project by Mapz Poker</p>
        <p class="mt-2 text-xs" id="user-id-el"></p>
    </footer>

</body>
</html>

